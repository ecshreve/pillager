<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# hunter

```go
import "github.com/brittonhayes/pillager/pkg/hunter"
```

Package hunter contains the types\, methods\, and interfaces for the file hunting functionality of pillager\.

## Index

- [Constants](<#constants>)
- [func ParseRulesFromConfigFile(filepath string) (*gitleaks.Config, error)](<#func-parserulesfromconfigfile>)
- [func RenderTemplate(w *os.File, tpl string, f scan.Report)](<#func-rendertemplate>)
- [type Config](<#type-config>)
  - [func DefaultConfig() *Config](<#func-defaultconfig>)
  - [func NewConfig(path string, verbose bool, gitleaks *gitleaks.Config, format Format, template string, workers int) *Config](<#func-newconfig>)
  - [func (c *Config) Validate() error](<#func-config-validate>)
- [type Format](<#type-format>)
  - [func StringToFormat(s string) Format](<#func-stringtoformat>)
  - [func (f Format) String() string](<#func-format-string>)
- [type Hound](<#type-hound>)
  - [func NewHound(f Format, t *string) *Hound](<#func-newhound>)
  - [func (h *Hound) Howl()](<#func-hound-howl>)
- [type Hunter](<#type-hunter>)
  - [func NewHunter(c *Config) *Hunter](<#func-newhunter>)
  - [func (h *Hunter) Hunt() error](<#func-hunter-hunt>)


## Constants

DefaultPillagerConfig is the default ruleset for pillager's hunting parameters\. This can be overridden by providing a rules\.toml file as an argument\.

```go
const DefaultPillagerConfig = `
title = "pillager config"
[[rules]]
	description = "AWS Access Key"
	regex = '''(A3T[A-Z0-9]|AKIA|AGPA|AIDA|AROA|AIPA|ANPA|ANVA|ASIA)[A-Z0-9]{16}'''
	tags = ["key", "AWS"]
[[rules]]
	description = "AWS Secret Key"
	regex = '''(?i)aws(.{0,20})?(?-i)['\"][0-9a-zA-Z\/+]{40}['\"]'''
	tags = ["key", "AWS"]
[[rules]]
	description = "Github"
	regex = '''(?i)github(.{0,20})?(?-i)[0-9a-zA-Z]{35,40}'''
	tags = ["key", "Github"]
[[rules]]
	description = "Slack"
	regex = '''xox[baprs]-([0-9a-zA-Z]{10,48})?'''
	tags = ["key", "Slack"]
[[rules]]
	description = "Asymmetric Private Key"
	regex = '''-----BEGIN ((EC|PGP|DSA|RSA|OPENSSH) )?PRIVATE KEY( BLOCK)?-----'''
	tags = ["key", "AsymmetricPrivateKey"]
[[rules]]
	description = "Slack Webhook"
	regex = '''https://hooks.slack.com/services/T[a-zA-Z0-9_]{8}/B[a-zA-Z0-9_]{8}/[a-zA-Z0-9_]{24}'''
	tags = ["key", "slack"]

[allowlist]
	description = "Allowlisted files"
	files = ['''^\.?gitleaks.toml$''',
	'''(.*?)(png|jpg|gif|doc|docx|pdf|bin|xls|pyc|zip)$''',
	'''(go.mod|go.sum)$''']
`
```

DefaultTemplate is the base template used to format a Finding into the custom output format\.

```go
const DefaultTemplate = `{{ with . -}}
{{ range .Leaks -}}
Line: {{.LineNumber}}
File: {{ .File }}
Offender: {{ .Offender }}

{{ end -}}{{- end}}`
```

## func [ParseRulesFromConfigFile](<https://github.com/brittonhayes/pillager/blob/main/pkg/hunter/config.go#L66>)

```go
func ParseRulesFromConfigFile(filepath string) (*gitleaks.Config, error)
```

ParseRulesFromConfigFile loads the rules defined in the config file into a list of gitleaks rules\.

## func [RenderTemplate](<https://github.com/brittonhayes/pillager/blob/main/pkg/hunter/template.go#L24>)

```go
func RenderTemplate(w *os.File, tpl string, f scan.Report)
```

RenderTemplate renders a Hound finding in a custom go template format to the provided writer\.

## type [Config](<https://github.com/brittonhayes/pillager/blob/main/pkg/hunter/config.go#L12-L19>)

Config holds all the configurable parameters for a Hunter\.

```go
type Config struct {
    BasePath string
    Verbose  bool
    Workers  int
    Gitleaks *gitleaks.Config
    Format   Format
    Template string
}
```

### func [DefaultConfig](<https://github.com/brittonhayes/pillager/blob/main/pkg/hunter/config.go#L34>)

```go
func DefaultConfig() *Config
```

DefaultConfig returns a Config with default values for the Hunter\.

### func [NewConfig](<https://github.com/brittonhayes/pillager/blob/main/pkg/hunter/config.go#L22>)

```go
func NewConfig(path string, verbose bool, gitleaks *gitleaks.Config, format Format, template string, workers int) *Config
```

NewConfig validates the given path and returns a new Config\.

### func \(\*Config\) [Validate](<https://github.com/brittonhayes/pillager/blob/main/pkg/hunter/config.go#L50>)

```go
func (c *Config) Validate() error
```

Validate returns an error if the given Config does not have the System or Rules fields populated\.

## type [Format](<https://github.com/brittonhayes/pillager/blob/main/pkg/hunter/format.go#L6>)

Format represents a possible output format for a Hound's findings\.

```go
type Format int
```

All possible output formats for a Hound\.

```go
const (
    JSONFormat Format = iota + 1
    YAMLFormat
    TableFormat
    HTMLFormat
    HTMLTableFormat
    MarkdownFormat
    CustomFormat
)
```

### func [StringToFormat](<https://github.com/brittonhayes/pillager/blob/main/pkg/hunter/format.go#L26>)

```go
func StringToFormat(s string) Format
```

StringToFormat takes in a string representing the preferred output format\, and returns the associated Format enum value\.

### func \(Format\) [String](<https://github.com/brittonhayes/pillager/blob/main/pkg/hunter/format.go#L20>)

```go
func (f Format) String() string
```

String implements the stringer interface for the Format type\.

## type [Hound](<https://github.com/brittonhayes/pillager/blob/main/pkg/hunter/hound.go#L16-L20>)

A Hound performs file inspection and collects the results\.

```go
type Hound struct {
    OutputFormat   Format
    CustomTemplate *string
    Findings       *scan.Report `json:"findings"`
}
```

### func [NewHound](<https://github.com/brittonhayes/pillager/blob/main/pkg/hunter/hound.go#L23>)

```go
func NewHound(f Format, t *string) *Hound
```

NewHound creates an instance of the Hound type from the given Config\.

### func \(\*Hound\) [Howl](<https://github.com/brittonhayes/pillager/blob/main/pkg/hunter/hound.go#L32>)

```go
func (h *Hound) Howl()
```

Howl prints out the findings from the Hound in the configured output format\.

<details><summary>Example (Json)</summary>
<p>

Here is an example of utilizing the Howl function on a slice of findings\. The Howl method is the final method in the hunting process\. It takes whatever has been found and outputs it for the user\.

```go
{
	h := NewHound(CustomFormat, &templates.Table)

	h.Findings = &scan.Report{
		Leaks: []scan.Leak{
			{
				Line:       "person@email.com",
				LineNumber: 16,
				Offender:   "person@email.com",
				Rule:       "Email Addresses",
				File:       "example.txt",
			},
			{
				Line:       "fred@email.com",
				LineNumber: 29,
				Offender:   "fred@email.com",
				Rule:       "Email Addresses",
				File:       "example2.txt",
			},
		},
	}

	h.Howl()

}
```

#### Output

```
---
Hooooowl -- üêï
---
| File    |  Line    | Offender |
| --------| ---------| -------- |
| example.txt | 16 | person@email.com |
| example2.txt | 29 | fred@email.com |
```

</p>
</details>

## type [Hunter](<https://github.com/brittonhayes/pillager/blob/main/pkg/hunter/hunter.go#L14-L17>)

Hunter holds the required fields to implement the Hunting interface and utilize the hunter package\.

```go
type Hunter struct {
    Config *Config
    Hound  *Hound
}
```

### func [NewHunter](<https://github.com/brittonhayes/pillager/blob/main/pkg/hunter/hunter.go#L20>)

```go
func NewHunter(c *Config) *Hunter
```

NewHunter creates an instance of the Hunter type from the given Config\.

### func \(\*Hunter\) [Hunt](<https://github.com/brittonhayes/pillager/blob/main/pkg/hunter/hunter.go#L35>)

```go
func (h *Hunter) Hunt() error
```

Hunt walks over the filesystem at the configured path\, looking for sensitive information\.

<details><summary>Example (Custom_output)</summary>
<p>

This method also accepts custom output format configuration using go template/html\. So if you don't like yaml or json\, you can format to your heart's content\.

```go
package main

import (
	"github.com/brittonhayes/pillager/pkg/hunter"
	"github.com/samsarahq/go/oops"
	gitleaks "github.com/zricethezav/gitleaks/v7/config"
	"log"
	"os"
)

type hunterTestEnv struct {
	gitleaks        *gitleaks.Config
	testFileName    string
	testFileContent string
}

func (e *hunterTestEnv) cleanup() {
	if err := os.Remove(e.testFileName); err != nil {
		log.Println(oops.Wrapf(err, "removing temporary test files"))
	}
}

// huntTestEnvHelper is a convenient helper to create temporary files
// with for the tests and examples in this package.
func huntTestEnvHelper(testFilePattern string, testFileContent string) (*hunterTestEnv, error) {
	gl, err := hunter.ParseRulesFromConfigFile("./testdata/pillager_test_config.toml")
	if err != nil {
		return nil, oops.Wrapf(err, "parsing config data for test env")
	}

	f, err := os.CreateTemp("./testdata", testFilePattern)
	if err != nil {
		return nil, oops.Wrapf(err, "creating test file for test env")
	}
	defer f.Close()

	_, err = f.WriteString(testFileContent)
	if err != nil {
		return nil, oops.Wrapf(err, "writing test file content for test env")
	}

	return &hunterTestEnv{
		gitleaks:        gl,
		testFileName:    f.Name(),
		testFileContent: testFileContent,
	}, nil
}

func main() {
	env, err := huntTestEnvHelper("~.yaml", "https://github.com/brittonhayes/pillager")
	if err != nil {
		log.Fatalln(oops.Wrapf(err, "creating test env"))
	}
	defer env.cleanup()

	config := hunter.NewConfig(env.testFileName, true, env.gitleaks, hunter.CustomFormat, hunter.DefaultTemplate, 1)
	h := hunter.NewHunter(config)

	if err = h.Hunt(); err != nil {
		log.Fatalln(oops.Wrapf(err, "failure to Hunt"))
	}

}
```

#### Output

```
{
	"line": "https://github.com/brittonhayes/pillager",
	"lineNumber": 1,
	"offender": "https://github.com/brittonhayes/pillager",
	"offenderEntropy": -1,
	"commit": "",
	"repo": "",
	"repoURL": "",
	"leakURL": "",
	"rule": "Github",
	"commitMessage": "",
	"author": "",
	"email": "",
	"file": ".",
	"date": "0001-01-01T00:00:00Z",
	"tags": "github"
}

---
Hooooowl -- üêï
---
Line: 1
File: .
Offender: https://github.com/brittonhayes/pillager
```

</p>
</details>

<details><summary>Example (Email)</summary>
<p>

This is an example of how to run a scan on a single file to look for email addresses\.

```go
package main

import (
	"github.com/brittonhayes/pillager/pkg/hunter"
	"github.com/samsarahq/go/oops"
	gitleaks "github.com/zricethezav/gitleaks/v7/config"
	"log"
	"os"
)

type hunterTestEnv struct {
	gitleaks        *gitleaks.Config
	testFileName    string
	testFileContent string
}

func (e *hunterTestEnv) cleanup() {
	if err := os.Remove(e.testFileName); err != nil {
		log.Println(oops.Wrapf(err, "removing temporary test files"))
	}
}

// huntTestEnvHelper is a convenient helper to create temporary files
// with for the tests and examples in this package.
func huntTestEnvHelper(testFilePattern string, testFileContent string) (*hunterTestEnv, error) {
	gl, err := hunter.ParseRulesFromConfigFile("./testdata/pillager_test_config.toml")
	if err != nil {
		return nil, oops.Wrapf(err, "parsing config data for test env")
	}

	f, err := os.CreateTemp("./testdata", testFilePattern)
	if err != nil {
		return nil, oops.Wrapf(err, "creating test file for test env")
	}
	defer f.Close()

	_, err = f.WriteString(testFileContent)
	if err != nil {
		return nil, oops.Wrapf(err, "writing test file content for test env")
	}

	return &hunterTestEnv{
		gitleaks:        gl,
		testFileName:    f.Name(),
		testFileContent: testFileContent,
	}, nil
}

func main() {
	env, err := huntTestEnvHelper("~.toml", "example@email.com")
	if err != nil {
		log.Fatalln(oops.Wrapf(err, "creating test env"))
	}
	defer env.cleanup()

	config := hunter.NewConfig(env.testFileName, true, env.gitleaks, hunter.JSONFormat, hunter.DefaultTemplate, 1)
	h := hunter.NewHunter(config)

	if err = h.Hunt(); err != nil {
		log.Fatalln(oops.Wrapf(err, "failure to Hunt"))
	}

}
```

#### Output

```
{
	"line": "example@email.com",
	"lineNumber": 1,
	"offender": "example@email.com",
	"offenderEntropy": -1,
	"commit": "",
	"repo": "",
	"repoURL": "",
	"leakURL": "",
	"rule": "Email",
	"commitMessage": "",
	"author": "",
	"email": "",
	"file": ".",
	"date": "0001-01-01T00:00:00Z",
	"tags": "email"
}

---
Hooooowl -- üêï
---
[{"line":"example@email.com","lineNumber":1,"offender":"example@email.com","offenderEntropy":-1,"commit":"","repo":"","repoURL":"","leakURL":"","rule":"Email","commitMessage":"","author":"","email":"","file":".","date":"0001-01-01T00:00:00Z","tags":"email"}]
```

</p>
</details>

<details><summary>Example (Toml)</summary>
<p>

Hunter will also look personally identifiable info in TOML files and format the output as HTML\.

```go
package main

import (
	"github.com/brittonhayes/pillager/pkg/hunter"
	"github.com/brittonhayes/pillager/templates"
	"github.com/samsarahq/go/oops"
	gitleaks "github.com/zricethezav/gitleaks/v7/config"
	"log"
	"os"
)

type hunterTestEnv struct {
	gitleaks        *gitleaks.Config
	testFileName    string
	testFileContent string
}

func (e *hunterTestEnv) cleanup() {
	if err := os.Remove(e.testFileName); err != nil {
		log.Println(oops.Wrapf(err, "removing temporary test files"))
	}
}

// huntTestEnvHelper is a convenient helper to create temporary files
// with for the tests and examples in this package.
func huntTestEnvHelper(testFilePattern string, testFileContent string) (*hunterTestEnv, error) {
	gl, err := hunter.ParseRulesFromConfigFile("./testdata/pillager_test_config.toml")
	if err != nil {
		return nil, oops.Wrapf(err, "parsing config data for test env")
	}

	f, err := os.CreateTemp("./testdata", testFilePattern)
	if err != nil {
		return nil, oops.Wrapf(err, "creating test file for test env")
	}
	defer f.Close()

	_, err = f.WriteString(testFileContent)
	if err != nil {
		return nil, oops.Wrapf(err, "writing test file content for test env")
	}

	return &hunterTestEnv{
		gitleaks:        gl,
		testFileName:    f.Name(),
		testFileContent: testFileContent,
	}, nil
}

func main() {
	env, err := huntTestEnvHelper("~.toml", "fakeperson@example.com")
	if err != nil {
		log.Fatalln(oops.Wrapf(err, "creating test env"))
	}
	defer env.cleanup()

	config := hunter.NewConfig(env.testFileName, true, env.gitleaks, hunter.HTMLFormat, templates.HTML, 1)
	h := hunter.NewHunter(config)

	if err = h.Hunt(); err != nil {
		log.Fatalln(oops.Wrapf(err, "failure to Hunt"))
	}
}
```

</p>
</details>



Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)
