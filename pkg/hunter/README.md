<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# hunter

```go
import "github.com/brittonhayes/pillager/pkg/hunter"
```

Package hunter contains the types\, methods\, and interfaces for the file hunting functionality of pillager\.

## Index

- [type Hunter](<#type-hunter>)
  - [func NewHunter(c config.Config) (*Hunter, error)](<#func-newhunter>)
  - [func (h *Hunter) Announce() error](<#func-hunter-announce>)
  - [func (h *Hunter) BuildReport(findings []report.Finding) error](<#func-hunter-buildreport>)
  - [func (h *Hunter) Hunt() error](<#func-hunter-hunt>)
- [type Leak](<#type-leak>)
- [type Report](<#type-report>)


## type [Hunter](<https://github.com/brittonhayes/pillager/blob/main/pkg/hunter/hunter.go#L10-L13>)

Hunter holds configuration and results\.

```go
type Hunter struct {
    Config *config.Config
    Report *Report
}
```

### func [NewHunter](<https://github.com/brittonhayes/pillager/blob/main/pkg/hunter/hunter.go#L16>)

```go
func NewHunter(c config.Config) (*Hunter, error)
```

NewHunter creates an instance of the Hunter type from the given Config\.

### func \(\*Hunter\) [Announce](<https://github.com/brittonhayes/pillager/blob/main/pkg/hunter/report.go#L44>)

```go
func (h *Hunter) Announce() error
```

Announce handles outputting a Hunter's Report to stdout\.

<details><summary>Example (Table)</summary>
<p>

Here is an example of utilizing the Announce function on a Report\. The Announce method is the final method in the hunting process\. It takes whatever has been found and outputs it for the user\.

```go
{
	cfg, err := NewTestConfig(".", config.TableFormat, templates.Table)
	if err != nil {
		log.Fatalln(err)
	}

	h, err := hunter.NewHunter(*cfg)
	if err != nil {
		log.Fatalln(err)
	}

	h.Report = &hunter.Report{
		Leaks: []hunter.Leak{
			{
				Secret:    "person@email.com",
				StartLine: 16,
				Match:     "person@email.com",
				RuleID:    "Email Addresses",
				File:      "example.txt",
			},
			{
				Secret:    "fred@email.com",
				StartLine: 29,
				Match:     "fred@email.com",
				RuleID:    "Email Addresses",
				File:      "example2.txt",
			},
		},
	}

	err = h.Announce()
	if err != nil {
		log.Fatalln(err)
	}

}
```

#### Output

```
--- Results ---
---
| File    |  Line    | Offender |
| --------| ---------| -------- |
| example.txt | 16 | person@email.com |
| example2.txt | 29 | fred@email.com |
```

</p>
</details>

### func \(\*Hunter\) [BuildReport](<https://github.com/brittonhayes/pillager/blob/main/pkg/hunter/report.go#L22>)

```go
func (h *Hunter) BuildReport(findings []report.Finding) error
```

### func \(\*Hunter\) [Hunt](<https://github.com/brittonhayes/pillager/blob/main/pkg/hunter/hunter.go#L29>)

```go
func (h *Hunter) Hunt() error
```

Hunt walks over the filesystem at the configured path\, looking for sensitive information\. Checking each file under the configured path is accomplished with Gitleaks Detect functionality\.

<details><summary>Example (Simple)</summary>
<p>

This is an example of how to run a scan on a single file to look for email addresses\.

```go
{
	env, err := HuntTestEnvHelper("./testdata/email.toml", "example@email.com")
	if err != nil {
		log.Fatalln(oops.Wrapf(err, "creating test env"))
	}

	cfg, _ := NewTestConfig(env.TestFilePath, config.JSONFormat, templates.JSON)
	h, _ := hunter.NewHunter(*cfg)

	if err = h.Hunt(); err != nil {
		log.Fatalln(oops.Wrapf(err, "failure to Hunt"))
	}

}
```

#### Output

```
{
	"Description": "Email",
	"StartLine": 2,
	"EndLine": 2,
	"StartColumn": 1,
	"EndColumn": 17,
	"Match": "example@email.com",
	"Secret": "example@email.com",
	"File": "./testdata/email.toml",
	"Commit": "",
	"Entropy": 0,
	"Author": "",
	"Email": "",
	"Date": "",
	"Message": "",
	"Tags": [
		"email"
	],
	"RuleID": ""
}
--- Results ---
---
[{"Description":"Email","StartLine":2,"EndLine":2,"StartColumn":1,"EndColumn":17,"Match":"example@email.com","Secret":"example@email.com","File":"./testdata/email.toml","Commit":"","Entropy":0,"Author":"","Email":"","Date":"","Message":"","Tags":["email"],"RuleID":""}]
```

</p>
</details>

<details><summary>Example (Template)</summary>
<p>

This method also accepts custom output format configuration using go template/html\. So if you don't like yaml or json\, you can format to your heart's content\.

```go
{
	env, err := HuntTestEnvHelper("./testdata/package.toml", "https://github.com/brittonhayes/pillager")
	if err != nil {
		log.Fatalln(oops.Wrapf(err, "creating test env"))
	}

	cfg, _ := NewTestConfig(env.TestFilePath, config.CustomFormat, config.DefaultTemplate)
	h, _ := hunter.NewHunter(*cfg)

	if err = h.Hunt(); err != nil {
		log.Fatalln(oops.Wrapf(err, "failure to Hunt"))
	}

}
```

#### Output

```
{
	"Description": "Github",
	"StartLine": 2,
	"EndLine": 2,
	"StartColumn": 1,
	"EndColumn": 40,
	"Match": "https://github.com/brittonhayes/pillager",
	"Secret": "https://github.com/brittonhayes/pillager",
	"File": "./testdata/package.toml",
	"Commit": "",
	"Entropy": 0,
	"Author": "",
	"Email": "",
	"Date": "",
	"Message": "",
	"Tags": [
		"github"
	],
	"RuleID": ""
}
--- Results ---
---
Line: 2
File: ./testdata/package.toml
Offender: https://github.com/brittonhayes/pillager
```

</p>
</details>

<details><summary>Example (Toml)</summary>
<p>

Hunter will also look personally identifiable info in TOML files and format the output as HTML\.

```go
{
	env, err := HuntTestEnvHelper("./testdata/email.toml", "fakeperson@example.com")
	if err != nil {
		log.Fatalln(oops.Wrapf(err, "creating test env"))
	}

	config, _ := NewTestConfig(env.TestFileContent, config.HTMLFormat, templates.HTML)
	h, _ := hunter.NewHunter(*config)

	if err = h.Hunt(); err != nil {
		log.Fatalln(oops.Wrapf(err, "failure to Hunt"))
	}
}
```

</p>
</details>

## type [Leak](<https://github.com/brittonhayes/pillager/blob/main/pkg/hunter/report.go#L14>)

```go
type Leak report.Finding
```

## type [Report](<https://github.com/brittonhayes/pillager/blob/main/pkg/hunter/report.go#L17-L20>)

Report includes data related to the results of a Gitleaks Detect\.

```go
type Report struct {
    Leaks        []Leak
    SimpleString string
}
```



Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)
