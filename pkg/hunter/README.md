<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# hunter

```go
import "github.com/brittonhayes/pillager/pkg/hunter"
```

Package hunter contains the types\, methods\, and interfaces for the file hunting functionality of pillager\.

## Index

- [type Hound](<#type-hound>)
  - [func NewHound(f config.Format, t *string) *Hound](<#func-newhound>)
  - [func (h *Hound) Howl()](<#func-hound-howl>)
- [type Hunter](<#type-hunter>)
  - [func NewHunter(c *config.Cfg) *Hunter](<#func-newhunter>)
  - [func (h *Hunter) Hunt() error](<#func-hunter-hunt>)


## type [Hound](<https://github.com/brittonhayes/pillager/blob/main/pkg/hunter/hound.go#L14-L18>)

A Hound performs file inspection and collects the results\.

```go
type Hound struct {
    OutputFormat   config.Format
    CustomTemplate *string
    Findings       *scan.Report `json:"findings"`
}
```

### func [NewHound](<https://github.com/brittonhayes/pillager/blob/main/pkg/hunter/hound.go#L21>)

```go
func NewHound(f config.Format, t *string) *Hound
```

NewHound creates an instance of the Hound type from the given Config\.

### func \(\*Hound\) [Howl](<https://github.com/brittonhayes/pillager/blob/main/pkg/hunter/hound.go#L30>)

```go
func (h *Hound) Howl()
```

Howl prints out the findings from the Hound in the configured output format\.

<details><summary>Example (Json)</summary>
<p>

Here is an example of utilizing the Howl function on a slice of findings\. The Howl method is the final method in the hunting process\. It takes whatever has been found and outputs it for the user\.

```go
{
	h := NewHound(config.CustomFormat, &templates.Table)

	h.Findings = &scan.Report{
		Leaks: []scan.Leak{
			{
				Line:       "person@email.com",
				LineNumber: 16,
				Offender:   "person@email.com",
				Rule:       "Email Addresses",
				File:       "example.txt",
			},
			{
				Line:       "fred@email.com",
				LineNumber: 29,
				Offender:   "fred@email.com",
				Rule:       "Email Addresses",
				File:       "example2.txt",
			},
		},
	}

	h.Howl()

}
```

#### Output

```
---
Hooooowl -- üêï
---
| File    |  Line    | Offender |
| --------| ---------| -------- |
| example.txt | 16 | person@email.com |
| example2.txt | 29 | fred@email.com |
```

</p>
</details>

## type [Hunter](<https://github.com/brittonhayes/pillager/blob/main/pkg/hunter/hunter.go#L15-L18>)

Hunter holds the required fields to implement the Hunting interface and utilize the hunter package\.

```go
type Hunter struct {
    Config *config.Cfg
    Hound  *Hound
}
```

### func [NewHunter](<https://github.com/brittonhayes/pillager/blob/main/pkg/hunter/hunter.go#L21>)

```go
func NewHunter(c *config.Cfg) *Hunter
```

NewHunter creates an instance of the Hunter type from the given Config\.

### func \(\*Hunter\) [Hunt](<https://github.com/brittonhayes/pillager/blob/main/pkg/hunter/hunter.go#L36>)

```go
func (h *Hunter) Hunt() error
```

Hunt walks over the filesystem at the configured path\, looking for sensitive information\.

<details><summary>Example (Simple)</summary>
<p>

This is an example of how to run a scan on a single file to look for email addresses\.

```go
{
	env, err := HuntTestEnvHelper("~tmp.toml", "example@email.com")
	if err != nil {
		log.Fatalln(oops.Wrapf(err, "creating test env"))
	}
	defer env.cleanup()

	config := config.NewCfg(env.TestFileName, true, env.Gitleaks, config.JSONFormat, helpers.DefaultTemplate, 1)
	h := hunter.NewHunter(config)

	if err = h.Hunt(); err != nil {
		log.Fatalln(oops.Wrapf(err, "failure to Hunt"))
	}

}
```

#### Output

```
{
	"line": "example@email.com",
	"lineNumber": 1,
	"offender": "example@email.com",
	"offenderEntropy": -1,
	"commit": "",
	"repo": "",
	"repoURL": "",
	"leakURL": "",
	"rule": "Email",
	"commitMessage": "",
	"author": "",
	"email": "",
	"file": ".",
	"date": "0001-01-01T00:00:00Z",
	"tags": "email"
}

---
Hooooowl -- üêï
---
[{"line":"example@email.com","lineNumber":1,"offender":"example@email.com","offenderEntropy":-1,"commit":"","repo":"","repoURL":"","leakURL":"","rule":"Email","commitMessage":"","author":"","email":"","file":".","date":"0001-01-01T00:00:00Z","tags":"email"}]
```

</p>
</details>

<details><summary>Example (Template)</summary>
<p>

This method also accepts custom output format configuration using go template/html\. So if you don't like yaml or json\, you can format to your heart's content\.

```go
{
	env, err := HuntTestEnvHelper("~tmp.yaml", "https://github.com/brittonhayes/pillager")
	if err != nil {
		log.Fatalln(oops.Wrapf(err, "creating test env"))
	}
	defer env.cleanup()

	config := config.NewCfg(env.TestFileName, true, env.Gitleaks, config.CustomFormat, helpers.DefaultTemplate, 1)
	h := hunter.NewHunter(config)

	if err = h.Hunt(); err != nil {
		log.Fatalln(oops.Wrapf(err, "failure to Hunt"))
	}

}
```

#### Output

```
{
	"line": "https://github.com/brittonhayes/pillager",
	"lineNumber": 1,
	"offender": "https://github.com/brittonhayes/pillager",
	"offenderEntropy": -1,
	"commit": "",
	"repo": "",
	"repoURL": "",
	"leakURL": "",
	"rule": "Github",
	"commitMessage": "",
	"author": "",
	"email": "",
	"file": ".",
	"date": "0001-01-01T00:00:00Z",
	"tags": "github"
}

---
Hooooowl -- üêï
---
Line: 1
File: .
Offender: https://github.com/brittonhayes/pillager
```

</p>
</details>

<details><summary>Example (Toml)</summary>
<p>

Hunter will also look personally identifiable info in TOML files and format the output as HTML\.

```go
{
	env, err := HuntTestEnvHelper("~tmp.toml", "fakeperson@example.com")
	if err != nil {
		log.Fatalln(oops.Wrapf(err, "creating test env"))
	}
	defer env.cleanup()

	config := config.NewCfg(env.TestFileName, true, env.Gitleaks, config.HTMLFormat, templates.HTML, 1)
	h := hunter.NewHunter(config)

	if err = h.Hunt(); err != nil {
		log.Fatalln(oops.Wrapf(err, "failure to Hunt"))
	}
}
```

</p>
</details>



Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)
