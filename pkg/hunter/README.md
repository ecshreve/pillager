<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# hunter

```go
import "github.com/brittonhayes/pillager/pkg/hunter"
```

Package hunter contains the types\, methods\, and interfaces for the file hunting functionality of pillager\.

## Index

- [Constants](<#constants>)
- [func RenderTemplate(w io.Writer, tpl string, f scan.Report)](<#func-rendertemplate>)
- [type Config](<#type-config>)
  - [func NewConfig(fs afero.Fs, path string, verbose bool, gitleaks gitleaks.Config, format Format, template string, workers int) *Config](<#func-newconfig>)
  - [func (c *Config) Default() *Config](<#func-config-default>)
  - [func (c *Config) Validate() (err error)](<#func-config-validate>)
- [type Configer](<#type-configer>)
- [type Format](<#type-format>)
  - [func StringToFormat(s string) Format](<#func-stringtoformat>)
  - [func (f Format) String() string](<#func-format-string>)
- [type Hound](<#type-hound>)
  - [func NewHound(c *Config) *Hound](<#func-newhound>)
  - [func (h *Hound) Howl(findings scan.Report)](<#func-hound-howl>)
- [type Hounder](<#type-hounder>)
- [type Hunter](<#type-hunter>)
  - [func NewHunter(c *Config) *Hunter](<#func-newhunter>)
  - [func (h Hunter) Hunt() error](<#func-hunter-hunt>)
- [type Hunting](<#type-hunting>)


## Constants

DefaultTemplate is the base template used to format a Finding into the custom output format\.

```go
const DefaultTemplate = `{{ with . -}}
{{ range .Leaks -}}
Line: {{.LineNumber}}
File: {{ .File }}
Offender: {{ .Offender }}

{{ end -}}{{- end}}`
```

## func [RenderTemplate](<https://github.com/brittonhayes/pillager/blob/main/pkg/hunter/template.go#L23>)

```go
func RenderTemplate(w io.Writer, tpl string, f scan.Report)
```

RenderTemplate renders a Hound finding in a custom go template format to the provided writer\.

## type [Config](<https://github.com/brittonhayes/pillager/blob/main/pkg/hunter/config.go#L13-L21>)

Config holds all the configurable parameters for a Hunter\.

```go
type Config struct {
    System   afero.Fs
    BasePath string
    Verbose  bool
    Workers  int
    Gitleaks gitleaks.Config
    Format   Format
    Template string
}
```

### func [NewConfig](<https://github.com/brittonhayes/pillager/blob/main/pkg/hunter/config.go#L33>)

```go
func NewConfig(fs afero.Fs, path string, verbose bool, gitleaks gitleaks.Config, format Format, template string, workers int) *Config
```

NewConfig validates the given path and returns a new Config\.

### func \(\*Config\) [Default](<https://github.com/brittonhayes/pillager/blob/main/pkg/hunter/config.go#L47>)

```go
func (c *Config) Default() *Config
```

Default returns a Config with default values for the Hunter\.

### func \(\*Config\) [Validate](<https://github.com/brittonhayes/pillager/blob/main/pkg/hunter/config.go#L61>)

```go
func (c *Config) Validate() (err error)
```

Validate returns an error if the given Config does not have the System or Rules fields populated\.

## type [Configer](<https://github.com/brittonhayes/pillager/blob/main/pkg/hunter/config.go#L27-L30>)

The Configer interface defines the available methods for instances of the Config type\.

```go
type Configer interface {
    Default() *Config
    Validate() (err error)
}
```

## type [Format](<https://github.com/brittonhayes/pillager/blob/main/pkg/hunter/format.go#L6>)

Format represents a possible output format for a Hound's findings\.

```go
type Format int
```

All possible output formats for a Hound\.

```go
const (
    JSONFormat Format = iota + 1
    YAMLFormat
    TableFormat
    HTMLFormat
    HTMLTableFormat
    MarkdownFormat
    CustomFormat
)
```

### func [StringToFormat](<https://github.com/brittonhayes/pillager/blob/main/pkg/hunter/format.go#L26>)

```go
func StringToFormat(s string) Format
```

StringToFormat takes in a string representing the preferred output format\, and returns the associated Format enum value\.

### func \(Format\) [String](<https://github.com/brittonhayes/pillager/blob/main/pkg/hunter/format.go#L20>)

```go
func (f Format) String() string
```

String implements the stringer interface for the Format type\.

## type [Hound](<https://github.com/brittonhayes/pillager/blob/main/pkg/hunter/hound.go#L15-L18>)

A Hound performs file inspection and collects the results\.

```go
type Hound struct {
    Config   *Config
    Findings scan.Report `json:"findings"`
}
```

### func [NewHound](<https://github.com/brittonhayes/pillager/blob/main/pkg/hunter/hound.go#L29>)

```go
func NewHound(c *Config) *Hound
```

NewHound creates an instance of the Hound type from the given Config\.

### func \(\*Hound\) [Howl](<https://github.com/brittonhayes/pillager/blob/main/pkg/hunter/hound.go#L43>)

```go
func (h *Hound) Howl(findings scan.Report)
```

Howl prints out the findings from the Hound in the configured output format\.

<details><summary>Example (Json)</summary>
<p>

Here is an example of utilizing the Howl function on a slice of findings\. The Howl method is the final method in the hunting process\. It takes whatever has been found and outputs it for the user\.

```go
{
	h := NewHound(&Config{
		System:   afero.NewMemMapFs(),
		Gitleaks: rules.Load(""),
		Format:   JSONFormat,
	})
	findings := scan.Report{
		Leaks: []scan.Leak{
			{Line: "person@email.com", LineNumber: 16, Offender: "person@email.com", Rule: "Email Addresses"},
		},
	}

	h.Howl(findings)
}
```

</p>
</details>

## type [Hounder](<https://github.com/brittonhayes/pillager/blob/main/pkg/hunter/hound.go#L24-L26>)

The Hounder interface defines the available methods for instances of the Hound type\.

```go
type Hounder interface {
    Howl(findings scan.Report)
}
```

## type [Hunter](<https://github.com/brittonhayes/pillager/blob/main/pkg/hunter/hunter.go#L14-L17>)

Hunter holds the required fields to implement the Hunting interface and utilize the hunter package\.

```go
type Hunter struct {
    Config *Config
    Hound  *Hound
}
```

### func [NewHunter](<https://github.com/brittonhayes/pillager/blob/main/pkg/hunter/hunter.go#L27>)

```go
func NewHunter(c *Config) *Hunter
```

NewHunter creates an instance of the Hunter type from the given Config\.

### func \(Hunter\) [Hunt](<https://github.com/brittonhayes/pillager/blob/main/pkg/hunter/hunter.go#L44>)

```go
func (h Hunter) Hunt() error
```

Hunt walks over the filesystem at the configured path\, looking for sensitive information\.

<details><summary>Example (Custom_output)</summary>
<p>

This method also accepts custom output formats using go template/html\. So if you don't like yaml or json\, you can format to your heart's content\.

```go
{
	fs := afero.NewMemMapFs()
	f, err := fs.Create("example.yaml")
	if err != nil {
		panic(err)
	}
	defer f.Close()

	_, err = f.Write([]byte(`https://github.com/brittonhayes/pillager`))
	if err != nil {
		panic(err)
	}

	config := NewConfig(fs, "./", true, rules.Load(""), CustomFormat, DefaultTemplate, 5)
	h := NewHunter(config)
	_ = h.Hunt()
}
```

</p>
</details>

<details><summary>Example (Email)</summary>
<p>

This is an example of how to run a scan on a single file to look for email addresses\. We're using an in\-memory file system for simplicity\, but this supports using an actual file system as well\.

```go
{
	fs := afero.NewMemMapFs()
	f, err := fs.Create("example.toml")
	if err != nil {
		panic(err)
	}
	defer f.Close()

	_, err = f.Write([]byte(`example@email.com`))
	if err != nil {
		panic(err)
	}

	config := NewConfig(fs, "./", true, rules.Load(""), StringToFormat("yaml"), DefaultTemplate, 5)
	h := NewHunter(config)
	_ = h.Hunt()
}
```

</p>
</details>

<details><summary>Example (Json)</summary>
<p>

This method accepts json output format as well

```go
{
	fs := afero.NewMemMapFs()
	f, err := fs.Create("fake.json")
	if err != nil {
		panic(err)
	}
	defer f.Close()
	_, err = f.Write([]byte(`git@github.com:brittonhayes/pillager.git`))
	if err != nil {
		panic(err)
	}

	config := NewConfig(fs, ".", true, rules.Load(""), JSONFormat, DefaultTemplate, 5)
	h := NewHunter(config)
	_ = h.Hunt()
}
```

</p>
</details>

<details><summary>Example (Toml)</summary>
<p>

Hunter will also look personally identifiable info in TOML

```go
{
	fs := afero.NewMemMapFs()
	f, err := fs.Create("fake.toml")
	if err != nil {
		panic(err)
	}
	defer f.Close()
	_, err = f.Write([]byte(`fakeperson@example.com`))
	if err != nil {
		panic(err)
	}

	config := NewConfig(fs, ".", true, rules.Load(""), JSONFormat, DefaultTemplate, 5)

	h := NewHunter(config)
	_ = h.Hunt()
}
```

</p>
</details>

## type [Hunting](<https://github.com/brittonhayes/pillager/blob/main/pkg/hunter/hunter.go#L22-L24>)

Hunting is the primary API interface for the hunter package\.

```go
type Hunting interface {
    Hunt() error
}
```



Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)
