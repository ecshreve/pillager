<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# hunter

```go
import "github.com/brittonhayes/pillager/pkg/hunter"
```

Package hunter contains the types\, methods\, and interfaces for the file hunting functionality of pillager\.

## Index

- [func BuildOutputString(f config.Format, tmp *string, rep Report) string](<#func-buildoutputstring>)
- [func RenderTemplate(w io.Writer, tpl string, r Report)](<#func-rendertemplate>)
- [type Hound](<#type-hound>)
  - [func NewHound(f config.Format, t *string) *Hound](<#func-newhound>)
  - [func (h *Hound) Howl()](<#func-hound-howl>)
- [type Hunter](<#type-hunter>)
  - [func NewHunter(c *config.Cfg) *Hunter](<#func-newhunter>)
  - [func (h *Hunter) Hunt() error](<#func-hunter-hunt>)
- [type Report](<#type-report>)


## func [BuildOutputString](<https://github.com/brittonhayes/pillager/blob/main/pkg/hunter/hound.go#L60>)

```go
func BuildOutputString(f config.Format, tmp *string, rep Report) string
```

BuildOutputString returns the string result of applying the given template and format to the data in the report\.

## func [RenderTemplate](<https://github.com/brittonhayes/pillager/blob/main/pkg/hunter/hound.go#L47>)

```go
func RenderTemplate(w io.Writer, tpl string, r Report)
```

RenderTemplate renders a Hound finding in a custom go template format to the provided writer\.

## type [Hound](<https://github.com/brittonhayes/pillager/blob/main/pkg/hunter/hound.go#L23-L27>)

A Hound performs file inspection and collects the results\.

```go
type Hound struct {
    OutputFormat   config.Format
    CustomTemplate *string
    Findings       *Report `json:"findings"`
}
```

### func [NewHound](<https://github.com/brittonhayes/pillager/blob/main/pkg/hunter/hound.go#L30>)

```go
func NewHound(f config.Format, t *string) *Hound
```

NewHound creates an instance of the Hound type from the given Config\.

### func \(\*Hound\) [Howl](<https://github.com/brittonhayes/pillager/blob/main/pkg/hunter/hound.go#L39>)

```go
func (h *Hound) Howl()
```

Howl prints out the findings from the Hound in the configured output format\.

<details><summary>Example (Json)</summary>
<p>

Here is an example of utilizing the Howl function on a slice of findings\. The Howl method is the final method in the hunting process\. It takes whatever has been found and outputs it for the user\.

```go
{
	h := NewHound(config.CustomFormat, &templates.Table)

	h.Findings = &Report{
		Leaks: []report.Finding{
			{
				Secret:    "person@email.com",
				StartLine: 16,
				Match:     "person@email.com",
				RuleID:    "Email Addresses",
				File:      "example.txt",
			},
			{
				Secret:    "fred@email.com",
				StartLine: 29,
				Match:     "fred@email.com",
				RuleID:    "Email Addresses",
				File:      "example2.txt",
			},
		},
	}

	h.Howl()

}
```

#### Output

```
---
Hooooowl -- üêï
---
| File    |  Line    | Offender |
| --------| ---------| -------- |
| example.txt | 16 | person@email.com |
| example2.txt | 29 | fred@email.com |
```

</p>
</details>

## type [Hunter](<https://github.com/brittonhayes/pillager/blob/main/pkg/hunter/hunter.go#L12-L15>)

Hunter holds configuration and reference to a Hound\.

```go
type Hunter struct {
    Config *config.Cfg
    Hound  *Hound
}
```

### func [NewHunter](<https://github.com/brittonhayes/pillager/blob/main/pkg/hunter/hunter.go#L18>)

```go
func NewHunter(c *config.Cfg) *Hunter
```

NewHunter creates an instance of the Hunter type from the given Config\.

### func \(\*Hunter\) [Hunt](<https://github.com/brittonhayes/pillager/blob/main/pkg/hunter/hunter.go#L33>)

```go
func (h *Hunter) Hunt() error
```

Hunt walks over the filesystem at the configured path\, looking for sensitive information\.

<details><summary>Example (Simple)</summary>
<p>

This is an example of how to run a scan on a single file to look for email addresses\.

```go
{
	env, err := HuntTestEnvHelper("./testdata/email.toml", "example@email.com")
	if err != nil {
		log.Fatalln(oops.Wrapf(err, "creating test env"))
	}

	config := config.NewCfg("./testdata/email.toml", true, config.JSONFormat, config.DefaultTemplate, 1, "", env.Rules)
	h := hunter.NewHunter(config)

	if err = h.Hunt(); err != nil {
		log.Fatalln(oops.Wrapf(err, "failure to Hunt"))
	}

}
```

#### Output

```
{
	"Description": "Email",
	"StartLine": 2,
	"EndLine": 2,
	"StartColumn": 1,
	"EndColumn": 17,
	"Match": "example@email.com",
	"Secret": "example@email.com",
	"File": "./testdata/email.toml",
	"Commit": "",
	"Entropy": 0,
	"Author": "",
	"Email": "",
	"Date": "",
	"Message": "",
	"Tags": [
		"email"
	],
	"RuleID": ""
}

---
Hooooowl -- üêï
---
[{"Description":"Email","StartLine":2,"EndLine":2,"StartColumn":1,"EndColumn":17,"Match":"example@email.com","Secret":"example@email.com","File":"./testdata/email.toml","Commit":"","Entropy":0,"Author":"","Email":"","Date":"","Message":"","Tags":["email"],"RuleID":""}]
```

</p>
</details>

<details><summary>Example (Template)</summary>
<p>

This method also accepts custom output format configuration using go template/html\. So if you don't like yaml or json\, you can format to your heart's content\.

```go
{
	env, err := HuntTestEnvHelper("./testdata/package.toml", "https://github.com/brittonhayes/pillager")
	if err != nil {
		log.Fatalln(oops.Wrapf(err, "creating test env"))
	}

	config := config.NewCfg("./testdata/package.toml", true, config.CustomFormat, config.DefaultTemplate, 1, "", env.Rules)
	h := hunter.NewHunter(config)

	if err = h.Hunt(); err != nil {
		log.Fatalln(oops.Wrapf(err, "failure to Hunt"))
	}

}
```

#### Output

```
{
	"Description": "Github",
	"StartLine": 2,
	"EndLine": 2,
	"StartColumn": 1,
	"EndColumn": 40,
	"Match": "https://github.com/brittonhayes/pillager",
	"Secret": "https://github.com/brittonhayes/pillager",
	"File": "./testdata/package.toml",
	"Commit": "",
	"Entropy": 0,
	"Author": "",
	"Email": "",
	"Date": "",
	"Message": "",
	"Tags": [
		"github"
	],
	"RuleID": ""
}

---
Hooooowl -- üêï
---
Line: 2
File: ./testdata/package.toml
Offender: https://github.com/brittonhayes/pillager
```

</p>
</details>

<details><summary>Example (Toml)</summary>
<p>

Hunter will also look personally identifiable info in TOML files and format the output as HTML\.

```go
{
	env, err := HuntTestEnvHelper("./testdata/email.toml", "fakeperson@example.com")
	if err != nil {
		log.Fatalln(oops.Wrapf(err, "creating test env"))
	}

	config := config.NewCfg(env.TestFilePath, true, config.HTMLFormat, templates.HTML, 1, "", env.Rules)
	h := hunter.NewHunter(config)

	if err = h.Hunt(); err != nil {
		log.Fatalln(oops.Wrapf(err, "failure to Hunt"))
	}
}
```

</p>
</details>

## type [Report](<https://github.com/brittonhayes/pillager/blob/main/pkg/hunter/hound.go#L18-L20>)

```go
type Report struct {
    Leaks []report.Finding
}
```



Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)
